---
title: "Practico 1"
---

## Ejercicio 1
Considere el problema de la ruina del jugador.

(a) Escribir un programa mediante el cual simular y visualizar la evolución del capital del jugador A.

(b) Desarrollar el programa anterior de manera de estimar, mediante la simulación de un número adecuado de trayectorias del capital de jugador A:

(i) la probabilidad de ruina del jugador A, en función de su estado inicial $X_0 = k$, para valores asignados del capital total $S$ y de la probabilidad, $p$, de que el jugador A gane en cada etapa del juego;

(ii) la probabilidad de ruina del jugador A, en función de su probabilidad $p$ de ganar en cada etapa del juego, para valores asignados del capital total $S$ y del estado inicial $X_0 = k$.

(c) Visualizar las estimaciones de la probabilidad de ruina del jugador A y compararlas con las correspondientes expresiones analíticas.

## Ejercicio 2
Considere el problema de la ruina del jugador y, en particular, la variable aleatoria $T_{0;S}$ = duración del juego.

(a) Ampliar el programa de computación desarrollado en el ejercicio anterior a los efectos de estimar, mediante la simulación de un número adecuado de trayectorias del capital de jugador A:

(i) la duración esperada del juego, en función del capital inicial del jugador A, $X_0 = k$, para valores asignados del capital total $S$ y de la probabilidad, $p$, de que el jugador A gane en cada etapa del juego;

(ii) la duración esperada del juego, en función de la probabilidad, $p$, de que el jugador A gane en cada etapa del juego, para valores asignados del capital total $S$ y del estado inicial $X_0 = k$.

(b) Visualizar las estimaciones de la duración esperada del juego y compararlas con las correspondientes expresiones analíticas.

## Ejercicio 3
Consideramos un juego de ruina del jugador con posibilidad de empate (también llamado lazy random walk): en el tiempo $n$ la ganancia $X_n$ del Jugador A puede aumentar en una unidad con probabilidad $r \in (0; 1/2]$, disminuir en una unidad con probabilidad $r$, o permanecer igual con probabilidad $1 - 2r$. Definimos

$$ f (k) := P(RA | X_0 = k) $$

como la probabilidad de ruina del Jugador A, y

$$ h(k) := E[T_{0;S} | X_0 = k] $$

como la esperanza de la duración del juego $T_{0;S}$ comenzando en $X_0 = k$, para $k = 0; 1; \dots ; S$.

(a) Usando first step analysis, escriba la ecuación en diferencias que satisface $f (k)$ y sus condiciones de contorno, $k = 0; 1; \dots ; S$. Nos referiremos a esta ecuación como la ecuación homogénea.

(b) Resuelva la ecuación homogénea del apartado (a) por el método de su preferencia. ¿Es esta solución compatible con su intuición del problema? ¿Por qué?

(c) Usando first step analysis, escriba la ecuación en diferencias que satisface $h(k)$ y sus condiciones de contorno, $k = 0; 1; \dots ; S$.

(d) Encuentre una solución particular de la ecuación del apartado (c).

(e) Resuelva por completo la ecuación del apartado (c). Sugerencia: recuerde que la solución general es la suma de una solución particular y una solución de la ecuación homogénea.

(f) ¿Cómo se comporta la duración media $h(k)$ cuando $r \to 0$? ¿Es esta solución compatible con su intuición del problema? ¿Por qué?

## Ejercicio 4
Consideramos un proceso en tiempo discreto $(X_n)_{n\ge 0}$ que modela la fortuna de un jugador con estados en $\{0; 1; \dots ; S\}$, con probabilidades de transición

$$ P(X_{n+1} = k + 1 | X_n = k) = p; \quad k = 0; 1; \dots ; S - 1; $$
$$ P(X_{n+1} = k - 1 | X_n = k) = q; \quad k = 1; 2; \dots ; S; $$

y además

$$ P(X_{n+1} = 0 | X_n = 0) = q; $$

para todo $n \in \mathbb{N} = \{0; 1; 2; \dots\}$, donde $q = 1 - p$ y $p \in (0; 1]$. En este modelo, al alcanzar el estado 0 el jugador puede “rebotar” (quedarse en 0 con probabilidad $q$ o pasar a 1 con probabilidad $p$). Sea

$$ W = \bigcup_{n \in \mathbb{N}} \{X_n = S\} $$

el evento de que el jugador finalmente gana la partida.

1. Defina

$$ g(k) := P(W | X_0 = k); $$

la probabilidad de ganar habiendo partido del estado $k \in \{0; 1; \dots ; S\}$. Usando first step analysis, escriba las ecuaciones en diferencias satisfechas por $g(k)$, $k = 0; 1; \dots ; S - 1$, junto con sus condiciones de contorno (que pueden no darse de forma explícita). Esta pregunta es estándar, pero hay que prestar atención al comportamiento especial en el estado 0.

2. Obtenga $P(W | X_0 = k)$ para todo $k = 0; 1; \dots ; S$ como la solución única del sistema de ecuaciones planteado en el punto 1.

Observación: La respuesta es muy simple e intuitiva, pero se requiere una prueba (matemática).

3. Sea

$$ T_S := \inf\{n \ge 0 : X_n = S\} $$

el primer tiempo de llegada a $S$ del proceso $(X_n)_{n\ge 0}$, y

$$ h(k) := E[T_S | X_0 = k] $$

el tiempo esperado hasta que el jugador gana, partiendo de $k \in \{0; 1; \dots ; S\}$. Usando first step analysis, escriba las ecuaciones en diferencias satisfechas por $h(k)$ para $k = 0; 1; \dots ; S - 1$ e indique las condiciones de contorno correspondientes.

Nota: el estado 0 requiere especial cuidado; la ecuación para $h(0)$ adquiere una forma particular y puede verse como una segunda condición de contorno.

4. Calcule $E[T_S | X_0 = k]$ para todo $k = 0; 1; \dots ; S$ resolviendo las ecuaciones del punto 3.

Sugerencia: Esta cuestión es más difícil que el punto 2 y puede omitirse en una primera lectura (su resultado no se usa luego). Se puede resolver la ecuación homogénea para $k = 1; 2; \dots ; S - 1$; una solución particular se obtiene observando que aquí cuenta el tiempo hasta que gana el Jugador A (no B). Como de costumbre, hay que tratar por separado los casos $p \neq q$ y $p = q = 1/2$. La fórmula para $p = 1$ es intuitiva y puede ayudar a verificar el resultado.

5. Defina ahora

$$ T_0 := \inf\{n \ge 0 : X_n = 0\} $$

como el primer tiempo de llegada a 0. Escriba el valor de

$$ p_k := P(T_S < T_0 | X_0 = k); $$

como función de $p$, $S$ y $k$, para $k = 0; 1; \dots ; S$.

Nota: el evento $\{T_S < T_0\}$ significa “gana el Jugador A”.

6. Explique por qué vale la igualdad (aplique propiedad de Markov y homogeneidad temporal)

$$ P(T_S < T_0 | X_1 = k + 1; X_0 = k) = P(T_S < T_0 | X_0 = k + 1); $$

para $k = 0; 1; \dots ; S - 1$ (basta una explicación en palabras).

7. Usando la relación anterior, muestre que la probabilidad

$$ P(X_1 = k + 1 | X_0 = k \text{ y } T_S < T_0) = \frac{p p_{k+1}}{p_k}; $$

de un paso hacia arriba sabiendo que primero se alcanza $S$ es

para $k = 1; 2; \dots ; S - 1$, donde $p_k$ es el resultado del punto 5. ¿Cómo se compara esta probabilidad con el valor incondicional $p$?

8. Calcule la probabilidad

$$ P(X_1 = k - 1 | X_0 = k \text{ y } T_0 < T_S); \quad k = 1; 2; \dots ; S; $$

de un paso hacia abajo sabiendo que primero se alcanza 0, usando un argumento análogo al del punto 7.

9. Sea

$$ \hat{h}(k) := E[T_S | X_0 = k; T_S < T_0]; \quad k = 1; 2; \dots ; S; $$

el tiempo esperado hasta que el jugador gana, condicionado a que nunca se alcance el estado 0. Usando las probabilidades de transición condicionadas de los puntos 7 y 8, plantee las ecuaciones en diferencias satisfechas por $\hat{h}(k)$ para $k = 1; 2; \dots ; S - 1$ y sus condiciones de contorno.

Nota: la deducción es estándar, pero hay que manejar con cuidado las probabilidades de transición condicionales. Surge la duda de si $\hat{h}(0)$ debe aparecer en el sistema—este punto puede resolverse y debe explicitarse.

10. Resuelva la cuestión del punto 9 en el caso $p = 1/2$ y calcule $\hat{h}(k)$ para $k = 1; 2; \dots ; S$. ¿Qué puede decirse de $\hat{h}(0)$? La respuesta puede obtenerse usando un argumento de primer paso.

## Ejercicio 5
Sea $n \in \mathbb{N}$ y considere $n+1$ personas numeradas $0; 1; \dots ; n$ sentadas en círculo. En el instante $t = 0$ la persona $0$ sostiene el brócoli. En tiempos discretos $t = 1; 2; \dots :$, quien sostiene el brócoli lo pasa a su vecino de la izquierda o de la derecha con probabilidad $1/2$ cada una, de forma independiente de los pasos anteriores. Para $t \ge 0$, denote por

$$ A_t = \{ \text{personas que han tocado el brócoli alguna vez hasta el tiempo } t \} $$

el conjunto de personas “tocadas”. El juego termina en el tiempo

$$ T := \inf\{t \ge 0 : |A_t| = n\}; $$

es decir, cuando exactamente una persona no ha sido tocada; dicha persona es declarada ganadora y puede comer el brócoli.

Suponga que usted puede elegir su posición inicial $k \in \{0; 1; \dots ; n\}$ antes de comenzar. ¿Qué posición elegiría?
